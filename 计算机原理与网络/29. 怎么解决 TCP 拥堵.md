# 29. 怎么解决 TCP 拥堵？通过拥塞控制来解决。拥堵控制，就是防止过多的数据注入网络中，这样可以使网络中的路由器或链路不致过载。注意，拥塞控制和流量控制不同，前者是一个**全局性**的过程，而后者指**点对点**通信量的控制。

拥塞控制的方法主要有以下四种：

- 1、慢开始。
- 2、拥塞避免。
- 3、快重传。
- 4、快恢复。

**1）慢开始**

不要一开始就发送大量的数据，先探测一下网络的拥塞程度，也就是说由小到大逐渐增加拥塞窗口的大小。

**2）拥塞避免**

拥塞避免算法，让拥塞窗口缓慢增长，即每经过一个往返时间 RTT 就把发送方的拥塞窗口 cwnd 加 1 ，而不是加倍，这样拥塞窗口按线性规律缓慢增长。

[![慢开始和拥塞避免算法的实现举例](https://image-1302243118.cos.ap-beijing.myqcloud.com/img/96da7b757bb0dc2f2eaf86ac8ad20858)](http://static.iocoder.cn/3ed1936c7ee8639606bc8b3dccc2d5bc)慢开始和拥塞避免算法的实现举例

**3）快重传**

快重传，要求接收方在收到一个**失序的报文段**后就立即发出**重复确认**（为的是使发送方及早知道有报文段没有到达对方），而不要等到自己发送数据时捎带确认。

快重传算法规定，发送方只要一连收到三个重复确认，就应当立即重传对方尚未收到的报文段，而不必继续等待设置的重传计时器时间到期。

[![快重传的示意图](https://image-1302243118.cos.ap-beijing.myqcloud.com/img/96da7b757bb0dc2f2eaf86ac8ad20858)](http://static.iocoder.cn/96da7b757bb0dc2f2eaf86ac8ad20858)快重传的示意图

**4）快恢复**

快重传配合使用的还有快恢复算法，当发送方连续收到三个重复确认时，就执行“乘法减小”算法，把 ssthresh 门限减半。

- 但是接下去并不执行慢开始算法：因为如果网络出现拥塞的话就不会收到好几个重复的确认，所以发送方现在认为网络可能没有出现拥塞。
- 所以此时不执行慢开始算法，而是将 cwnd 设置为 ssthresh 的大小，然后执行拥塞避免算法。

[![从连续收到三个重复的确认转入拥堵避免](https://image-1302243118.cos.ap-beijing.myqcloud.com/img/96da7b757bb0dc2f2eaf86ac8ad20858)](http://static.iocoder.cn/d5ac995144720c33399d8e518cb973a6)

