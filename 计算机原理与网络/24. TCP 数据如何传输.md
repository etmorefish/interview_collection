# 24. TCP 数据如何传输？建立连接后，两台主机就可以相互传输数据了。如下图所示：[![TCP 套接字的数据交换过程](https://image-1302243118.cos.ap-beijing.myqcloud.com/img/6ed78395a32a0fbf56afed309dc1eb71)](http://static.iocoder.cn/6ed78395a32a0fbf56afed309dc1eb71)TCP 套接字的数据交换过程

- 上图给出了主机 A 分 2 次（分 2 个数据包）向主机 B 传递 200 字节的过程。

- 首先，主机 A 通过 1 个数据包发送 100 个字节的数据，数据包的

   

  ```
  Seq
  ```

   

  号设置为 1200 。主机 B 为了确认这一点，向主机 A 发送

   

  ```
  ACK
  ```

   

  包，并将

   

  ```
  Ack
  ```

   

  号设置为 1301 。

  - 为了保证数据准确到达，目标机器在收到数据包（包括 `SYN` 包、`FIN` 包、普通数据包等）包后必须立即回传 `ACK` 包，这样发送方才能确认数据传输成功。

  - 此时

     

    ```
    Ack
    ```

     

    号为 1301 而不是 1201，原因在于

     

    ```
    Ack
    ```

     

    号的增量为传输的数据字节数。假设每次

     

    ```
    Ack
    ```

     

    号不加传输的字节数，这样虽然可以确认数据包的传输，但无法明确 100 字节全部正确传递还是丢失了一部分，比如只传递了 80 字节。因此按如下的公式确认

     

    ```
    Ack
    ```

     

    号：

    ```
    Ack
    ```

     

    号 =

     

    ```
    Seq
    ```

     

    号 + 传递的字节数 + 1 。

    - 与三次握手协议相同，最后加 1 是为了告诉对方要传递的 `Seq` 号。

